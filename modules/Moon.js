console.log("%c [FPSZERO] SYSTEM INTEGRITY: VERIFIED", "color:#00ff00;background:#000;padding:4px;");
console.log("%c [FPSZERO] PROTOCOL: OMEGA-7 ACTIVE", "color:#00ff00;background:#000;padding:4px;");
/* FPSZERO SECURE TRANSMISSION
   UNAUTHORIZED DECOMPILATION PROHIBITED
   ---------------------------------------
*/
console.log("%c [FPSZERO] SYSTEM INTEGRITY: VERIFIED","color:#00ff00;background:#000;padding:4px;");console.log("%c [FPSZERO] PROTOCOL: OMEGA-7 ACTIVE","color:#00ff00;background:#000;padding:4px;");console.log("%c [FPSZERO] SYSTEM INTEGRITY: VERIFIED","color:#00ff00;background:#000;padding:4px;");console.log("%c [FPSZERO] PROTOCOL: OMEGA-7 ACTIVE","color:#00ff00;background:#000;padding:4px;");console.log("%c [FPSZERO] SYSTEM INTEGRITY: VERIFIED","color:#00ff00;background:#000;padding:4px;");console.log("%c [FPSZERO] PROTOCOL: OMEGA-7 ACTIVE","color:#00ff00;background:#000;padding:4px;");import*as THREE from 'three';export class Moon{constructor(scene,camera){this.scene=scene;this.camera=camera;this.mesh=null;this.sunLight=null;this.position=new THREE.Vector3(35,25,-50);this.radius=4;this.init();}init(){const phaseData=this.calculatePhase();const phaseAngleRad=phaseData.fraction*Math.PI*2;const visibility=Math.round(50*(1-Math.cos(phaseAngleRad)));console.log(`[FPSZERO ASTRO] Phase:${phaseData.name}| Vis:${visibility}%`);localStorage.setItem('fps_moon_phase',`${phaseData.name}[Vis:${visibility}%]`);const geometry=new THREE.SphereGeometry(this.radius,64,64);const textureLoader=new THREE.TextureLoader();const material=new THREE.MeshStandardMaterial({color:0xcccccc,roughness:0.9,metalness:0.1});this.mesh=new THREE.Mesh(geometry,material);this.mesh.position.copy(this.position);this.mesh.lookAt(this.camera.position);const colorPath='Artifacts/textures/moon_color.jpg';const bumpPath='Artifacts/textures/moon_displacement.jpg';textureLoader.load(colorPath,(texture)=>{this.mesh.material.map=texture;this.mesh.material.needsUpdate=true;},undefined,(err)=>console.warn("Moon texture missing at "+colorPath));textureLoader.load(bumpPath,(texture)=>{this.mesh.material.bumpMap=texture;this.mesh.material.bumpScale=0.02;this.mesh.material.needsUpdate=true;});this.sunLight=new THREE.DirectionalLight(0xffffff,2.5);this.sunLight.castShadow=true;this.sunLight.shadow.mapSize.width=2048;this.sunLight.shadow.mapSize.height=2048;this.sunLight.shadow.bias=-0.0001;this.scene.add(this.mesh);this.scene.add(this.sunLight);const earthshine=new THREE.PointLight(0x334455,0.15);earthshine.position.copy(this.camera.position);this.scene.add(earthshine);this.updateSunPosition(phaseData.fraction);}updateSunPosition(fraction){if(!this.mesh)return;const forward=new THREE.Vector3().subVectors(this.mesh.position,this.camera.position).normalize();const right=new THREE.Vector3().crossVectors(new THREE.Vector3(0,1,0),forward).normalize();const angle=fraction*Math.PI*2;const zComponent=Math.cos(angle);const xComponent=Math.sin(angle);const rawDir=new THREE.Vector3().addScaledVector(forward,zComponent).addScaledVector(right,-xComponent);const bias=0.15;const biasedDir=rawDir.clone().addScaledVector(forward,-bias).normalize();const sunDistance=60;this.sunLight.position.copy(this.mesh.position).add(biasedDir.multiplyScalar(sunDistance));}calculatePhase(){const synodicMonth=29.53058867;const knownNewMoon=new Date('1970-01-07T20:35:00Z').getTime();const now=new Date().getTime();const msPerDay=1000*60*60*24;const daysSince=(now-knownNewMoon)/msPerDay;const fraction=(daysSince % synodicMonth)/synodicMonth;let name="New Moon";if(fraction>0.03 && fraction<0.23)name="Waxing Crescent";else if(fraction>=0.23 && fraction<=0.27)name="First Quarter";else if(fraction>0.27 && fraction<0.47)name="Waxing Gibbous";else if(fraction>=0.47 && fraction<=0.53)name="Full Moon";else if(fraction>0.53 && fraction<0.73)name="Waning Gibbous";else if(fraction>=0.73 && fraction<=0.77)name="Last Quarter";else if(fraction>0.77 && fraction<0.97)name="Waning Crescent";return{fraction,name};}update(time,delta){if(this.mesh)this.mesh.lookAt(this.camera.position);}}